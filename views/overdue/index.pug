extends ../layout

block content
  .row
    .col-12
      .d-flex.justify-content-between.align-items-center.mb-4
        h2 ðŸ“‹ Overdue Members & Fines
        .badge.bg-danger.fs-6= overdueMembers.length + ' Members'

  if overdueMembers.length > 0
    .row
      each member in overdueMembers
        .col-md-6.mb-4
          .card.border-danger
            .card-header.bg-danger.text-white
              .d-flex.justify-content-between.align-items-center
                div
                  h5.mb-0= member.member.name
                  small= member.member.email
                .badge.bg-light.text-danger.fs-6 $#{member.totalFine}
            
            .card-body
              each book in member.overdueBooks
                .border-bottom.pb-2.mb-2
                  .row
                    .col-8
                      strong= book.book.title
                      br
                      small.text-muted by #{book.book.author}
                      br
                      small Due: #{book.dueDate.toDateString()}
                    .col-4.text-end
                      .badge.bg-warning.text-dark #{book.daysOverdue} days
                      br
                      .text-danger.fw-bold $#{book.fine}
              
              .mt-3.d-flex.justify-content-between
                form(method='POST', action=`/overdue/reminder/${member.member._id}`, style='display: inline;')
                  button.btn.btn-sm.btn-outline-primary(type='submit') Send Reminder
                form(method='POST', action=`/overdue/mark-paid/${member.member._id}`, style='display: inline;')
                  button.btn.btn-sm.btn-success(type='submit', onclick='return confirm("Mark fine as paid?")') Mark Paid
  else
    .col-12
      .alert.alert-success.text-center
        h4 ðŸŽ‰ No Overdue Members!
        p All books have been returned on time.

  script(src='/js/overdue.js')